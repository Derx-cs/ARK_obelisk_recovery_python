# ARK_obelisk_recovery_python
A python script to recover greyed-out dinos from the obelisks in the game ARK Survival Evolved

# The Problem
In the game ARK Survival Evolved, it is possible to upload ones creatures in obelisks, transmitters and similar structures, so one is able to download them on another server or singleplayer. But sometimes (especially in the recent Aquatica Release) Creatures grey out, when ones try to download them, which makes them unrecoverable in game, effectively the tame is lost. This is caused by a corruption in the binary file. The creature itself is still there, but the DinoClass is corrupted.

# The Solution and how this script works
The solution is to manually uncorrupt the DinoClass in the binary. For that, 3 Infos are needed, 2 characters and a blueprint path. This path is where the Creatures property is stored, so the game knows where to look for them. The characters are actually just the binary representation of the length of the paths name, one the exact length+1 and the other the exact length+9. These must be placed at the correct positions in the binary, together with some additional control symbols. This script runs through the whole binary, copying it. When it finds a line containing "DinoClass" it checks if it is corrupted. If yes, it looks for the creature in the database and puts together the correct line, which it writes to the binary.

The database information can either be aquired by reading uncorrupted dinos from the binary file. This was the primary methode before I discovered the characters are just the length of the path. 
Now the database is generated by getting all blueprint names from [fandom.](https://ark.fandom.com/wiki/Creature_IDs). This limits the dinos able to be recovered by the actuality of fandom, which is effectively not updated since lost island. Additional creatures can still be added by reading uncorrupted dinos or sharing the database. In future versions I might update it to read from the new Arkwiki.gg, so it includes all up-to-date creatures.

# Requirements
-python 3.x installed
-pandas (for managing the database) and urllib (for scraping the wiki) python packages

# Usage
1. Download Script and save it somewhere
2. Open Script in Editor (e.g. Notepad ++, VSCode)
3. Adjust the path variables in line 4-8 as needed
4. (Optional) Adjust the print flags in line 11-14 as wished
5. (Optional) Adjust code calls in line 218-224 as wished
6. **Backup your PlayerLocalData.arkprofile in case something goes wrong**
7. Run script via the command line
8. Replace the otiginal PlayerLocalData.arkprofile with the generated one

# Known Problems and Limitations
1. Recovery of dinos affected by the Classical Flyers Mod currently not working
2. If the dinos are still greyed-out, try downloading them on another map. Either the one where they were originally uploaded from, or to which DLC they belong to. If they are still greyed-out they may be corrupted again, so the script might need to rerun
3. This was developed, tested and used on ARK Version 360.6 . It needs testing on up-to-date versions
